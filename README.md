### QPE-FIT (Fast Inference with Timing)

This repository contains the code for QPE-FIT, which is a Bayesian parameter estimation tool to fit Quasi-Periodic Eruption timings with an extreme mass-ratio inspiral (EMRI) orbit colliding with the accretion disk surrounding a massive black hole. In its currrent rendition, PE is performed with Markov Chain Monte Carlo (MCMC), though there are future plans to explore other algorithms.

The relevant scripts included, with a listing of required keyword arguments, are:


`generate_timings.py`
- EMRI semimajor axis (Rg/gravitational radii)
- EMRI eccentricity
- EMRI inclination (degrees)
- MBH spin
- log(MBH mass) (solar)
- Observer viewing angle (radians)
- Disk inclination angle (degrees)
- Disk precession period (multiples of EMRI orbital period)
- Observation windows (seconds)
- Output file to store QPE timings
- Output file to store observation windows (this is a helper file to pass the info along to the MCMC scripts)

`mcmc_fixedphase.py`
- emcee backend file (.h5 file to store the output chain)
- timing file (.dat file as generated by the previous script)
- observing window file (.dat file as generated by the previous script)
- number of MCMC steps to run
- number of parallel walkers to include
- time step resolution for trial parameter trajectories (seconds)
```
python generate_timings.py 100 0.1 60 0.998 6 0.785 5 20 [[0,100000],[1100000,1200000],[2200000,2300000],[3300000,3400000]] timings.dat windows.dat
python mcmc_fixedphase.py output)chain.h5 timiings.dat windows.dat 100000 1000 10
```
